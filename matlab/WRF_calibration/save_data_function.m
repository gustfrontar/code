function save_data_function(name,date,time,struct)

%% Me genero la fecha para guardarla.
for i=1:length(struct.Vel)
    f_date(i,:)=datevec(datenum(date)+(time/1440)*i);    
end

%% Calculo la suma de la potencia de todas las turbinas
total=sum(struct.Vel,2);

%% Guardo en excel
Data=[f_date(:,1:5) struct.Vel total];
xlswrite(name,Data,'Potencia','A2');
xlswrite(name,{'Fecha','Mes','Dia','Minutos','Segundos'},'Potencia','A1');

%% Guardo en txt
file= fopen([name '.txt'], 'w');
for i=1:length(struct.Vel)
    fprintf(file,...
'%d\t%d\t%d\t%d\t%d\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f\t%10.5f \n',...
        f_date(i,1),f_date(i,2),...
        f_date(i,3),f_date(i,4),f_date(i,5),struct.Vel(i,1),struct.Vel(i,2),struct.Vel(i,3),...
        struct.Vel(i,4),struct.Vel(i,5),struct.Vel(i,6),struct.Vel(i,7),struct.Vel(i,8),...
        struct.Vel(i,9),struct.Vel(i,10),struct.Vel(i,11),struct.Vel(i,12),struct.Vel(i,13),...
        struct.Vel(i,14),struct.Vel(i,15),struct.Vel(i,16),struct.Vel(i,17),struct.Vel(i,18),...
        struct.Vel(i,19),struct.Vel(i,20),struct.Vel(i,21),struct.Vel(i,22),struct.Vel(i,23),...
        struct.Vel(i,24),struct.Vel(i,25),struct.Vel(i,26),struct.Vel(i,27),struct.Vel(i,28),...
        struct.Vel(i,29),struct.Vel(i,30),struct.Vel(i,31),struct.Vel(i,32),struct.Vel(i,33),...
        struct.Vel(i,34),struct.Vel(i,35),struct.Vel(i,36),struct.Vel(i,37),struct.Vel(i,38),...
        struct.Vel(i,39),struct.Vel(i,40),struct.Vel(i,41),struct.Vel(i,42),struct.Vel(i,43),total(i));
end 
fclose(file);
return